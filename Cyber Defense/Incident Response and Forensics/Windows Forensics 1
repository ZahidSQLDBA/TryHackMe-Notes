Introduction to Windows Forensics
-Computer forensics: gathering evidence of activities performed on computers
-part of wider Digital Forensics
-80% of desktop computers run Microsoft Windows

Forensic Artifacts
-Artifact: essential pieces of information that provide evidence of human activity.
-footprints of activity left on the computer system
-windows system creates artifacts for a given activity
-originated as effort to improve user experience

-----------------------------------------------------------------------------------------------

Windows Registry
-Windows Registry: collection of databases that contain the system config data
-data about hardware, software or user info
-data about recently used files, programs, devices connected
-read data using regedit.exe (built-in windows utility to view and edit the registry)
-consists of key and values
-Five root keys
1. HKEY_CURRENT_USER: root config info for user who is currently logged on 
-user's folders, screen colors, control panel settings are stored here
-associated with the user's profilie
-abbreviated HKCU

2. HKEY_HKEY_USERS: all actively loaded user profiles on the computer
-HKEY_CURRENT_USER is a subkey of HKEY_USERS. 
-abbreviated HKU

3. HKEY_LOCAL_MACHINE: info particular to a computer for any user
-abbreviated HKLM

4. HKEY_CLASSES_ROOT: subkey of HKEY_LOCAL_MACHINE\software
-info stored here makes sure that correct program opens using windows explorer
-abbreviated HKCR 
-merges the information from two sources: HKLM\Software\Classes & HKCU\Software\Classes
-merged view for programs that are designed for earlier versions of windows

5. HKEY_CURRENT_CONFIG: info about the hardware profile used by the local computer at system startup

-run (Windows key + R) > regedit.exe

-----------------------------------------------------------------------------------------------

Accessing Registry Hives Offline
-live system access - regedit.exe
-disk image C:\Windows\System32\Config
1. Default - HKEY_USERS\DEFAULT
2. SAM - HKEY_LOCAL_MACHINE\SAM
3. SECURITY - HKEY_LOCAL_MACHINE\Security
4. SOFTWARE - HKEY_LOCAL_MACHINE\Software
5. SYSTEM - HKEY_LOCAL_MACHINE\System

user profile directory: C:\Users\<username>\
1. NTUSER.DAT - HKEY_CURRENT_USER when user logs in
2. USRCLASS.DAT - HKEY_CURRENT_USER\Software\CLASSES
-USRCLASS.DAT is located C:\USERS\<username>\AppData\Local\Microsoft\Windows

Amcache hive
-AmCache - located in C:\Windows\AppCompat\Programs\AmCache.hve
-windows creates this hive to save information on programs that were recently run on the system

Transaction Logs and Backups
-registry transaction logs and backups - vital sources of forensic data
-transaction logs - changelog of the registry hive 
-windows uses transaction logs when writing data to registry hives
-stored in .LOG file extension
-SAM hive transaction log - C:\Windows\System32\Config - SAM.LOG
-multiple logs can be present .LOG1, .LOG2 etc

-Registry backups located in C:\Windows\System32\Config
-copied to C:\Windows\System32\Config\RegBack - every ten days

What is the path for the five main registy hives: Defautl, SAM, Security, Software and System?
-C:\Windows\System32\Config

What is the path for AmCache hive?
-C:\Windows\AppCompat\Programs\AmCache.hve

--------------------------------------------------------------------------------------------

Data Acquisition

