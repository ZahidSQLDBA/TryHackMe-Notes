Malware Campaigns

Targeted
-created for a specific purpose
-example: DarkHotel Malware (https://www.kaspersky.co.uk/resource-center/threats/darkhotel-malware-virus-threat-definition)

Mass Campaign
-most common
-purpose is to infect as many devices as possible
-example: Crouching Yeti(Energetic Bear) campaign (https://www.kaspersky.co.uk/resource-center/threats/crouching-yeti-energetic-bear-malware-threat)

Stuxnet is a computer worm that was originally aimed at Iran's nuclear facilities
Wannacry is a ransomware that used the Eternalblue exploit in a "Mass Campaign" attack

----------------------------------------------------------------------------------------------------------------------------------------------------------

Identifying a Malware attack happened

-Malware is largely obstrusive - it leaves an extensive trail of evidence
-Malware attack process
1. Delivery - (USB, PDF attachements etc)
2. Execution - (Encryption-Ransomeware, record info such as keystrokes-Spyware etc)
3. Maintaining Persistence (not always) - noisy stage - make sure "execution" is worth its while
4. Propagation (not always) - spread to other devices
-steps generate lots of data
-network traffic, system interaction read/writes and modifications
-Malware is classified based on behaviours
-Host Based Signatures: results of execution and persistence performed by malware
-Network Based signatures: any network communication taking plae during delivery,execution and propagation

---------------------------------------------------------------------------------------------------------------------------------------------------------

Static vs. Dynamic Analysis

Static Analysis
-gain high-level abstraction of the sample
-analysis of sample at the state it presents itself as without executing code
-techniques such as signature analysis via checksums - quick, efficient/brief and safe 

Dynamic Analysis
-involves executing sample and observing what happens
-could be harmful to computer and network

--------------------------------------------------------------------------------------------------------------------------------------------

Tools and Uses

Static Tools

PE Tools
-Dependency Walker (depends)
-PeID
-PE Explorer
-PEview
-ResourceHacker

Disassembly
-IDA Freeware
-WinDbg

Sysinternalsuite
-ResourceHacker

-------------------------------------------------------------------------------------------------------------------------------------------------

Obtaining MD5 Checksums of provided files

MD5 "Checksums" are prominent attribute
-cryptographic "fingerprints"
-identify the genus using their MD5 sum check against https://www.virustotal.com/gui/
-MD5 Checksum aws.exe?
D2778164EF643BA8F44CC202EC7EF157
-MD5 Checksum Netlogo.exe?
59CB421172A89E1E16C11A428326952C
-MD5 Checksum vlc.exe?
5416BE1B804B1681CB39CF0E2CAAD9F

--------------------------------------------------------------------------------------------------------------------------------------------------

Virustotal
-aws.exe?
Not Malicious
-Netlogo.exe?
Not Malicious
-vlc.exe?
Not Malicious

--------------------------------------------------------------------------------------------------------------------------------------------

Identifying compiler / packer of a file using PeID
1DE9176AD682FF.dll?
Microsoft Visual C++ 6.0 DLL
AD29AA1B.bin?
Microsoft Visual C++ 6.0 DLL

----------------------------------------------------------------------------------------------------------------------------------------------

Obfuscation / Packing
-Packing is a form of obfuscation - employed by malware authors to prevent analysis of programs - prevent decompiling
-legitimate reason: prevent theft of intellectual property
-malware authors: prevent reverse engineering
-What packer does PeID report file "6F431F46547DB2628" to be packed with?
FSG 1.0 -> dulek/xt

