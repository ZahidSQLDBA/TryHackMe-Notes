Sysinternals
-compilation of over 70+ Windows-based tools
-Categories of tools:
1. File and Disk Utilities
2. Netwoork Utilities
3. Process Utilities
4. Security Utilities
5. System Information
6. Miscellaneous


-----------------------------------------------------------------

install sysinternals suite

powershell
get-service webclient
start-service webclient
control.exe /name Microsoft.NetworkAndSharingCenter > Advanced sharing > Turn on network Discovery
powershell
Install-WindowsFeature WebDAV-Redirector -Restart
Get-WindowsFeature WebDAV-Redirector | Format-Table -Autosize

Command line:
\\live.sysinternals.com\tools\procmon.exe

What service needs to be enabled on the local host to interact with live.sysinternals.com? Webclient

-----------------------------------------------------------------------

Sigcheck
-command-line utility that shows file version number, timestamp information, digital signature details
-check for unsigned files in C:\Windows\System32
sigcheck -u -e C:\Windows\System32 -accepteula
-u: shows files that are unknown by virusTotal or have non-zero detection, unsigned files
-e: scan executable images only regardless of their extension

Streams
NTFS: new technology file system, every file has at least one data stream ($DATA) 
-ADS: alternate data streams allows files to contain more than one stream of data
-Windows explorer doesn't natively display ADS to the user
-Malware writers have used ADS to hide data in an endpoint but not all its users are malicious

SDelete
-commandline utility that take a number of options and allows the user to delete one or more files and/or directories or to cleanse the free space on a logical disk
-Secure Delete 
-DOD 5220.22-M Wipe Method
1. zero - verifies the write
2. one - verifies the write
3. writes a random character and verifies the write
-used by Adversaries in Data Destruction, Indicator Removal on Host:File Deletion

stream file.txt
file.txt:ads.txt
answer: I am hiding in this stream

-------------------------------------------------------------------------------------------------------------

TCPView
-Windows program that shows detailed listing of all TCP and UDP endpoints on your system
-Tcpvcon: command-line version with same functionality
-Resource Monitor tool has simliar functionality - built in utility on Windows
-command-line: resmon

tcpview -accepteula
52.152.110.14 - Microsoft Corporation

------------------------------------------------------------------------------------------------------------

Autoruns
-shows what programs are configured to run during system bootup or login
-Autoruns reports explorer shell extensions, toolbars, browser helper objects, winlogon notification, auto-start services and more
-Good tool to search for any malicious entries

ProcDump
-command-line utility that monitors an application of CPU spikes and generating crash dumps during spike

Process Explorer
-consists of two sub-windows
-Top: list of currenlty active processes, names of owning accounts
-Bottom: handle-mode - handles that the process selected. DLL-mode - dlls and memory-mapped files that the process has loaded
-check TCP/IP tab to see Remote address
-look up IP using WHOIS
-can verify signatures using ProcExp

Process Monitor
-command-line: procmon -accepteula
-advanced monitoring tool for windows
-Guide to configure procmon: https://adamtheautomator.com/procmon/

PsExec
-light-weight telnet-replacement that allows the execution of processes on other systems
-interactive command-prompts on remote systems
-remote-enabling tools like IpConfig
-additional info: https://docs.microsoft.com/en-us/sysinternals/downloads/psexec

command-line: autoruns -accepteula
Image Hijacks tab > taskmgr.exe
updated value: C:\TOOLS\SYSINT\PROCEXP.EXE
