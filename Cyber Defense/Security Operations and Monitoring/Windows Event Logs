Event Logs - record events taking place in the execution of a system 
-provide audit trail
-sys admins, IT techs, desktop engineers etc
-the OS writes messages to these logs
-SIEMs (Security Information and Event Management) - Splunk and Elastic
-SIEMs query the log of multiple machines

-Linux: Syslog (logging system)

xfreerdp /u:administrator /p:blueT3aming! /v:[IP]

-----------------------------------------------------------------------------------

Event Viewer
-stored in binary format with a .evt or .evtx 
-C:\Windows\System32\winevt\Logs
-three ways to acces event logs
1. Event Viewer (GUI-based application)
2. Wevtutil.exe (CLI)
3. Get-WinEvent (PowerShell cmdlet)

right click start menu > event viewer
cmd > eventvwr.msc
Panes
1. left: hierarchical tree listing of the event log 
2. Middle: general overview and summary or the events specific to a selected provider
3. right: actions pane

Types of logs
1. Error - loss of data or loss of functionality (servicie fails to load during start up)
2. Warning - indication of possible future problems (low disk space)
3. Information - description of successful operation of an application, driver or service
4. Success Audit - security access attempt that is successful
5. Failure Audit - security access attempt that is a failure

middle pane: level, date and time, source, event ID, task category

---------------------------------------------------------------------------------------------

Wevtutil.exe
-enables to retrieve information about event logs and publishers
-commands are used to install, uninstall event manifests
-run queries 
-export, archive and clear logs

wevtutil.exe /?
-help files
-example under Usage
-ep(enum-publishers): command

wevtutil COMMAND [ARGUMENT [ARGUMENT] ...] [/OPTION:VALUE [/OPTION:VALUE] ...]

wevtutil COMMAND /?
-information specific to commands
eg: wevtutil qe /?
-query events

wevtutil el | Measure-Object: 1071
wevtutil qe /?
-Read events from an event log, log file or using structured query
-path to a log file: /lf:true
-value for /q: xpath query
wevtutil qe Application /c:3 /rd:true /f:text
log name: Application
/rd: event read direction
/c: maximum number of events to read

----------------------------------------------------------------------------------------

Get-WinEvent
-gets events from event logs and event tracing log files on local and remote computers
-gets classic logs such as system and application logs
-get events in logs files generated by Event Tracing for Windows (ETW)
Get-WinEvent cmdlet replaces Get-EventLog cmdlet
Get-WinEvent -LogName Application | Where-Object {$_.ProviderName -Match 'WLMS'}
-FilterHashTable: recommended for processing large event logs
@{ <name>= <value>; [<name> = <value>]...}
-hash table begins with @
-enclose hash table with braces {}
-key/value pairs
-semi colon omitted if key value pairs are on separate lines
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-PowerShell/Operational'; ID=4104} | Select-Object -Property Message | Select-String -Pattern 'SecureString'

specify number of events: -MaxEvents
filter hashtable informational: 4

-------------------------------------------------------------------------------------------------------------
XPath
-XML Path Language
-created by W3C
-start with '*' or 'Event'
-wevtutil and Get-WinEvent support XPath queries as event filters
-Event Viewer > > Details > XML View
example: 
Get-WinEvent -LogName Application -FilterXPath '*/system/EventID=100'
wevtutil.exe qe Application /q:*/System[EventID=100] /f:text /c:1
-can query using provider name
Get-WinEvent -LogName Application -FilterXPath '*/System/EventID=101 and */System/Provider[@Name="WLMS"]'
Get-WinEvent -LogName Application -FilterXPath '*/System/Provider[@Name="WLMS"] and */System/TimeCreated[@SystemTime="2020-12-15T01:09:08.940277500Z"]'
Get-WinEvent -LogName Security -FilterXPath '*/EventData/Data[@Name="TargetUserName"]="Sam" and */System/EventID=4720'
Get-WinEvent -LogName Security -FilterXPath '*/EventData/Data[@Name="TargetUserName"]="Sam" and */System/EventID=4724'

---------------------------------------------------------------------------------------------------------------------------





