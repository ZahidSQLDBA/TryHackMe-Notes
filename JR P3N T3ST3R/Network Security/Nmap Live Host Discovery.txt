Nmap (network mapper) - efficient tool to discover which systems are up and what services are running on these systems
-map networks, id live hosts, discover running services
-port scanning offline systems wastes time and creates unnecessary noise on the network
-nmap automates and makes scanning efficient
-has scripting engine to extend functionality

-A network segment is a group of computers connected using a shared medium (ethernet switch or wifi access point)
-subnet with /16, 255.255.0.0 can have 65 thousand hosts
-subnet with /24, 255.255.255.0 can have 250 hosts

-If connected to the same subnet, scanner can rely on ARP (Address Resolution Protocol) to discover live hosts
-ARP query: aims to get the hardware address (MAC address) communication over link-layer becomes possible
-ARP queries are not routed and cannot cross the subnet router
-ARP link-layer protocol
-ARP packets are bound to their subnet

Enumerating Targets
-target: IP, website
-range: IP.15-20
subnet: Machine_IP/30
input file for list of targets: nmap -iL list.txt
check list of host Nmap will scan: nmap -sL TARGETS
no DNS resolution: -n

Discovering Live Hosts
-OSI Model
1. Physical Layer & 2. Data Link Layer - ARP, Ethernet(802.3), WiFi(802.11), DSL, Bluetooth
3. Network Layer - IPv4, IPv6, ICMP, IPsec
4. Transport Layer - TCP, UDP
5. Session Layer & 6. Presentation Layer & 7. Application Layer - HTTP, HTTPS, SMTP, POP3, IMAP, SSH, FTP, SNMP, Telnet, RDP,..

ARP: sends a frame to broadcast address on a network segment asking a specific IP address to respond by providing its MAC address

ICMP: Type 8(Echo) and Type 0 (Echo Reply)

TCP/UDP: send a specially-crafted packet to common TCP or UDP ports to check if target responds (efficient when ICMP Echo is blocked)

Nmap host discovery using ARP
1. privileged user tries to scan targets on local network(ethernet), Nmap uses ARP requests
2. privileged user tries to scan targets outside of local network, Nmap uses ICMP echo requests, TCP ACK to port 80, TCP SYN to port 443, and ICMP timestamp request
3. Unprivileged user tries to scan targets outside of local network, Nmap uses TCP 3-way handshake by sending SYN packets to ports 80 and 443

discover live hosts without port-scanning: nmap -sn [target IP]
scan local networks without port-scanning: nmap -PR -sn [target IP]
-PR: ARP scan


